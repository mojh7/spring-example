name: Discord PR Notification

on:
  pull_request:
    types: [opened, reopened]
    
jobs:
  pr-notify-discord:
    runs-on: ubuntu-latest
    steps:
    - name: Failed when draft state
      id: check
      run: |
        echo ${{ github.event.pull_request.draft }}
        exit 1
        
    - name: Notify Discord
      id: notify
      run: |
        JSON_DATA='{
          "content": "ðŸ˜ƒ ${{ github.event.pull_request.user.login }}ë‹˜ì´ ìƒˆë¡œìš´ PRì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.",
          "embeds": [
            {
              "title": "${{ github.event.pull_request.title }}",
              "description": "Branch : ${{ github.event.pull_request.head.ref }} -> ${{ github.event.pull_request.base.ref }}\nURL: ${{ github.event.pull_request.html_url }}",
              "color": 3368703
            }
          ]
        }'
        curl -X POST \
          -H 'Content-Type: application/json' \
          -d "$JSON_DATA" \
          ${{ secrets.DISCORD }}
